<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Middleton Grange CMS</title>
    <meta name="robots" content="noindex, nofollow">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://www.middleton.school.nz/wp-content/uploads/2019/11/cropped-Middleton-Grange-Logo_1300px-32x32.png">

    <!-- Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

    <!-- Custom Admin Styles -->
    <link rel="stylesheet" href="css/admin.css">

    <!-- Feather Icons -->
    <script src="https://unpkg.com/feather-icons"></script>
</head>
<body class="bg-gray-100 min-h-screen">

    <!-- Main Layout -->
    <div class="flex h-screen overflow-hidden">

        <!-- Sidebar (will be loaded dynamically) -->
        <aside id="sidebar" class="w-64 bg-blue-900 text-white flex-shrink-0">
            <!-- Sidebar content loaded from components/sidebar.html -->
        </aside>

        <!-- Main Content Area -->
        <div class="flex-1 flex flex-col overflow-hidden">

            <!-- Header (will be loaded dynamically) -->
            <header id="header" class="bg-white shadow-sm">
                <!-- Header content loaded from components/header.html -->
            </header>

            <!-- Page Content -->
            <main class="flex-1 overflow-y-auto p-6">
                <!-- Page Title -->
                <div class="mb-6">
                    <h1 class="text-2xl font-bold text-gray-800">Dashboard</h1>
                    <p class="text-gray-600">Welcome back, <span id="welcome-name">there</span>! Here's an overview of your website.</p>
                </div>

                <!-- Firebase Not Configured Warning -->
                <div id="firebase-warning" class="hidden bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                    <div class="flex items-start">
                        <i data-feather="alert-triangle" class="w-5 h-5 text-yellow-600 mt-0.5 mr-3 flex-shrink-0"></i>
                        <div>
                            <h3 class="font-medium text-yellow-800">Firebase Not Configured</h3>
                            <p class="text-sm text-yellow-700 mt-1">
                                The CMS is running with placeholder Firebase credentials. To enable full functionality,
                                update <code class="bg-yellow-100 px-1 rounded">admin/js/firebase-config.js</code> with your Firebase project configuration.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Stats Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <!-- Total Pages -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center">
                            <div class="p-3 bg-blue-100 rounded-full">
                                <i data-feather="file-text" class="w-6 h-6 text-blue-600"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-500">Total Pages</p>
                                <p class="text-2xl font-bold text-gray-800" id="stat-total-pages">--</p>
                            </div>
                        </div>
                    </div>

                    <!-- Published Pages -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center">
                            <div class="p-3 bg-green-100 rounded-full">
                                <i data-feather="check-circle" class="w-6 h-6 text-green-600"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-500">Published</p>
                                <p class="text-2xl font-bold text-gray-800" id="stat-published">--</p>
                            </div>
                        </div>
                    </div>

                    <!-- Draft Pages -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center">
                            <div class="p-3 bg-yellow-100 rounded-full">
                                <i data-feather="edit-3" class="w-6 h-6 text-yellow-600"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-500">Drafts</p>
                                <p class="text-2xl font-bold text-gray-800" id="stat-drafts">--</p>
                            </div>
                        </div>
                    </div>

                    <!-- Media Files -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center">
                            <div class="p-3 bg-purple-100 rounded-full">
                                <i data-feather="image" class="w-6 h-6 text-purple-600"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-500">Media Files</p>
                                <p class="text-2xl font-bold text-gray-800" id="stat-media">--</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Secondary Stats Row -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <!-- Menu Sections -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="p-3 bg-indigo-100 rounded-full">
                                    <i data-feather="layers" class="w-6 h-6 text-indigo-600"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Menu Sections</p>
                                    <p class="text-2xl font-bold text-gray-800" id="stat-menu-sections">--</p>
                                </div>
                            </div>
                            <a href="menu-manager.html" class="text-indigo-600 hover:text-indigo-800">
                                <i data-feather="arrow-right" class="w-5 h-5"></i>
                            </a>
                        </div>
                    </div>

                    <!-- Users (Admin Only) -->
                    <div id="stat-users-card" class="bg-white rounded-lg shadow p-6 hidden">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="p-3 bg-pink-100 rounded-full">
                                    <i data-feather="users" class="w-6 h-6 text-pink-600"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">CMS Users</p>
                                    <p class="text-2xl font-bold text-gray-800" id="stat-users">--</p>
                                </div>
                            </div>
                            <a href="users.html" class="text-pink-600 hover:text-pink-800">
                                <i data-feather="arrow-right" class="w-5 h-5"></i>
                            </a>
                        </div>
                    </div>

                    <!-- Last Build Info -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="p-3 bg-teal-100 rounded-full">
                                    <i data-feather="globe" class="w-6 h-6 text-teal-600"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Site Status</p>
                                    <p class="text-sm font-semibold text-gray-800" id="stat-last-build">Ready to build</p>
                                </div>
                            </div>
                            <button id="build-site-btn" class="px-3 py-1.5 bg-teal-600 text-white text-sm rounded-lg hover:bg-teal-700 transition-colors">
                                Build
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Two Column Layout -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">

                    <!-- Quick Actions -->
                    <div class="bg-white rounded-lg shadow">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <h2 class="text-lg font-semibold text-gray-800">Quick Actions</h2>
                        </div>
                        <div class="p-6 space-y-3">
                            <a href="page-editor.html" class="flex items-center p-4 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors">
                                <i data-feather="plus-circle" class="w-5 h-5 text-blue-600 mr-3"></i>
                                <span class="font-medium text-blue-900">Create New Page</span>
                            </a>
                            <a href="media-library.html" class="flex items-center p-4 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors">
                                <i data-feather="upload" class="w-5 h-5 text-purple-600 mr-3"></i>
                                <span class="font-medium text-purple-900">Upload Media</span>
                            </a>
                            <a href="menu-manager.html" class="flex items-center p-4 bg-green-50 rounded-lg hover:bg-green-100 transition-colors">
                                <i data-feather="menu" class="w-5 h-5 text-green-600 mr-3"></i>
                                <span class="font-medium text-green-900">Manage Menu</span>
                            </a>
                            <a href="#" id="view-site-btn" target="_blank" class="flex items-center p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                                <i data-feather="external-link" class="w-5 h-5 text-gray-600 mr-3"></i>
                                <span class="font-medium text-gray-900">View Live Site</span>
                            </a>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="bg-white rounded-lg shadow">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <h2 class="text-lg font-semibold text-gray-800">Recent Activity</h2>
                        </div>
                        <div class="p-6">
                            <div id="activity-list" class="space-y-4">
                                <!-- Activity items will be loaded here -->
                                <div class="text-center text-gray-500 py-8">
                                    <i data-feather="clock" class="w-8 h-8 mx-auto mb-2 opacity-50"></i>
                                    <p>Loading activity...</p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Recently Modified Pages -->
                <div class="mt-6 bg-white rounded-lg shadow">
                    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                        <h2 class="text-lg font-semibold text-gray-800">Recently Modified Pages</h2>
                        <a href="pages.html" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                            View All &rarr;
                        </a>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Title</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Modified</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="recent-pages" class="divide-y divide-gray-200">
                                <!-- Pages will be loaded here -->
                                <tr>
                                    <td colspan="4" class="px-6 py-8 text-center text-gray-500">
                                        Loading pages...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </main>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>

    <!-- Firebase Configuration -->
    <script src="js/firebase-config.js"></script>

    <!-- Core Scripts -->
    <script src="js/auth.js"></script>
    <script src="js/components.js"></script>
    <script src="js/dashboard.js"></script>

    <!-- Initialize Feather Icons -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            feather.replace();
        });
    </script>
</body>
</html>
